<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoVision - AI bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã, –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ TradingView */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1A202C; /* –¢–µ–º–Ω—ã–π —Å–∏–Ω–µ-—Å–µ—Ä—ã–π —Ñ–æ–Ω */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ö—É */
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
            color: #E2E8F0; /* –°–≤–µ—Ç–ª—ã–π —Ç–µ–∫—Å—Ç */
        }
        .container {
            background-color: #2D3748; /* –ß—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            border-radius: 1rem; /* –°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            width: 100%;
            max-width: 500px; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
            box-sizing: border-box;
            min-height: 70vh; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
            display: flex;
            flex-direction: column;
        }
        .page {
            display: none;
            flex-grow: 1; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–Ω–∏–º–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .page.active {
            display: flex;
            flex-direction: column;
        }
        .btn-primary {
            background-image: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; /* –ë–æ–ª–µ–µ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ */
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            border: none;
            outline: none;
        }
        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }
        .btn-secondary {
            background-color: #4A5568;
            color: #E2E8F0;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .btn-secondary:hover {
            background-color: #64748B;
        }
        .loading-spinner {
            border: 4px solid #4A5568; /* –¶–≤–µ—Ç —Å–ø–∏–Ω–Ω–µ—Ä–∞ –ø–æ–¥ —Ç–µ–º–Ω—É—é —Ç–µ–º—É */
            border-top: 4px solid #63B3ED; /* –ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç —Å–ø–∏–Ω–Ω–µ—Ä–∞ */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∞–Ω–∞–ª–∏–∑–∞ */
        .card {
            background-color: #2C3440; /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
            border-radius: 1rem; /* –ë–æ–ª–µ–µ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            padding: 1.5rem; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
            margin-top: 1rem; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
            border: none; /* –£–±–∏—Ä–∞–µ–º —Ä–∞–º–∫—É */
        }
        .analysis-item span:first-child {
            font-weight: 600;
            color: #90CDF4; /* –°–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
        }
        .image-upload-area {
            border: 2px dashed #4A5568;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 1rem;
        }
        .image-upload-area:hover {
            border-color: #63B3ED;
            background-color: #374151;
        }
        .image-preview {
            max-width: 100%;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            border: 1px solid #4A5568;
        }
        .subscription-plan {
            background-color: #374151; /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –ø–ª–∞–Ω–æ–≤ –ø–æ–¥–ø–∏—Å–∫–∏ */
            border: 1px solid #4A5568;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .subscription-plan h3 {
            font-weight: 700;
            color: #E2E8F0;
            margin-bottom: 0.5rem;
        }
        .subscription-plan p {
            color: #CBD5E1;
            font-size: 0.9rem;
        }
        .payment-info {
            text-align: center;
            padding: 1rem;
            color: #CBD5E1;
        }
        .payment-info img {
            max-width: 80px;
            margin: 0 auto 1rem;
        }
        .text-green-600 { color: #68D391; } /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        .text-red-600 { color: #FC8181; } /* –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        .text-blue-600 { color: #63B3ED; } /* –ì–æ–ª—É–±–æ–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ "–ê–Ω–∞–ª–∏–∑" */
        .analysis-section-card {
            background-color: #2C3440; /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ü–∏–π –∞–Ω–∞–ª–∏–∑–∞ */
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem; /* –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .analysis-section-card h2 {
            font-size: 1.25rem; /* –ë–æ–ª—å—à–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
            font-weight: 700;
            color: #E2E8F0;
            margin-bottom: 1rem;
            text-align: center;
        }
        .key-insight-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        .insight-item {
            background-color: #374151; /* –§–æ–Ω –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω—Å–∞–π—Ç–æ–≤ */
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            color: #CBD5E1;
            font-size: 0.9rem;
        }
        .insight-item .icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #63B3ED; /* –ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –∏–∫–æ–Ω–æ–∫ */
        }
        .insight-item .value {
            font-weight: 600;
            color: #E2E8F0;
            margin-top: 0.25rem;
        }
        .game-plan-text {
            color: #CBD5E1;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        .detailed-analysis-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .detailed-analysis-list li {
            background-color: #374151;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.95rem;
            color: #E2E8F0;
        }
        .detailed-analysis-list li .number {
            background-color: #6a11cb; /* –¶–≤–µ—Ç –∫—Ä—É–∂–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º */
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }
        .detailed-analysis-list li .lock-icon {
            margin-left: 0.75rem;
            color: #9CA3AF; /* –°–µ—Ä—ã–π —Ü–≤–µ—Ç –¥–ª—è –∏–∫–æ–Ω–∫–∏ –∑–∞–º–∫–∞ */
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        .detailed-analysis-list li .text-content {
            flex-grow: 1;
        }
        .feature-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            color: #CBD5E1;
            font-size: 1rem;
        }
        .feature-item .icon {
            font-size: 1.2rem;
            margin-right: 0.75rem;
        }
        .feature-item.available .icon {
            color: #68D391; /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö */
        }
        .feature-item.unavailable {
            color: #718096; /* –°–µ—Ä—ã–π –¥–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö */
        }
        .feature-item.unavailable .icon {
            color: #E53E3E; /* –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö */
        }
        .locked-content {
            filter: blur(2px); /* –†–∞–∑–º—ã—Ç–∏–µ –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
            pointer-events: none; /* –û—Ç–∫–ª—é—á–∞–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ */
            user-select: none; /* –û—Ç–∫–ª—é—á–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ */
        }
        .lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 1rem;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Page -->
        <div id="welcomePage" class="page active">
            <h1 class="text-2xl font-bold text-center mb-6">CryptoVision - AI –±–æ—Ç</h1>
            <img src="https://placehold.co/150x150/2C3440/63B3ED?text=AI+Bot" alt="–õ–æ–≥–æ—Ç–∏–ø CryptoVision AI Bot" class="mx-auto mb-6 rounded-full shadow-lg">

            <p class="text-center text-gray-300 mb-6">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CryptoVision AI Bot! –ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥–æ–≤–æ–π –∞–Ω–∞–ª–∏–∑ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.
            </p>

            <div class="card mb-6">
                <h2 class="text-xl font-semibold text-center mb-4">–ù–∞—à–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</h2>
                <div class="space-y-3">
                    <div class="feature-item available">
                        <span class="icon">‚úÖ</span>
                        <span>AI-–∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–±–∞–∑–æ–≤—ã–π)</span>
                    </div>
                    <div class="feature-item available">
                        <span class="icon">‚úÖ</span>
                        <span>–¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–±–∞–∑–æ–≤—ã–µ)</span>
                    </div>
                    <div class="feature-item unavailable">
                        <span class="icon">‚ùå</span>
                        <span>–î–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</span>
                        <span class="ml-auto text-gray-500">üîí</span>
                    </div>
                    <div class="feature-item unavailable">
                        <span class="icon">‚ùå</span>
                        <span>–ù–æ–≤–æ—Å—Ç–Ω–æ–π –∞–Ω–∞–ª–∏–∑</span>
                        <span class="ml-auto text-gray-500">üîí</span>
                    </div>
                    <div class="feature-item unavailable">
                        <span class="icon">‚ùå</span>
                        <span>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</span>
                        <span class="ml-auto text-gray-500">üîí</span>
                    </div>
                </div>
            </div>
            <button class="btn-primary w-full mt-auto" onclick="showPage('analysisPage')">–î–∞–ª–µ–µ</button>
        </div>

        <!-- Analysis Page -->
        <div id="analysisPage" class="page">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">AI –ê–Ω–∞–ª–∏–∑ –ì—Ä–∞—Ñ–∏–∫–∞</h2>
                <button class="btn-secondary px-4 py-2" onclick="showInstructionModal()">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</button>
            </div>

            <div class="analysis-section-card mb-4">
                <label for="chartImageUpload" class="block text-sm font-medium mb-2 text-gray-300">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞:</label>
                <div class="image-upload-area" id="imageUploadArea">
                    <input type="file" id="chartImageUpload" accept="image/*" class="hidden">
                    <p class="text-gray-400">–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</p>
                    <img id="imagePreview" class="image-preview mx-auto" src="#" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä–∞—Ñ–∏–∫–∞">
                </div>
            </div>

            <button id="getAnalysisBtn" class="btn-primary w-full flex items-center justify-center mb-6">
                <span id="buttonText">–ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑</span>
                <div id="loadingSpinner" class="loading-spinner hidden ml-3"></div>
            </button>

            <div id="analysisResult" class="hidden">
                <h2 class="text-xl font-bold text-center mb-4">–í–∞—à –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π AI –∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞:</h2>

                <!-- Key Insights Section -->
                <div class="analysis-section-card">
                    <h2>–ö–ª—é—á–µ–≤—ã–µ –ò–Ω—Å–∞–π—Ç—ã</h2>
                    <div class="key-insight-grid mb-4">
                        <div class="insight-item">
                            <span class="icon">üìà</span>
                            <span>–¢—Ä–µ–Ω–¥</span>
                            <span class="value" id="outputTrend">–ë—ã—á–∏–π</span>
                        </div>
                        <div class="insight-item">
                            <span class="icon">üìä</span>
                            <span>–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
                            <span class="value" id="outputVolatility">–°—Ä–µ–¥–Ω—è—è</span>
                        </div>
                        <div class="insight-item">
                            <span>–û–±—ä–µ–º</span>
                            <span class="value" id="outputVolume">–í—ã—Å–æ–∫–∏–π</span>
                        </div>
                        <div class="insight-item">
                            <span>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞</span>
                            <span class="value" id="outputSentiment">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ</span>
                        </div>
                    </div>
                    <div class="space-y-2 text-gray-300">
                        <p class="analysis-item"><span class="text-blue-600">–î–µ–π—Å—Ç–≤–∏–µ:</span> <span id="outputAction" class="font-bold"></span></p>
                        <p class="analysis-item"><span class="text-blue-600">–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞:</span> <span id="outputEntryPrice"></span></p>
                        <p class="analysis-item"><span class="text-blue-600">–¶–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞:</span> <span id="outputTargetPrice"></span></p>
                        <p class="analysis-item"><span class="text-blue-600">–°—Ç–æ–ø-–ª–æ—Å—Å:</span> <span id="outputStopLoss"></span></p>
                        <p class="analysis-item"><span class="text-blue-600">–¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç:</span> <span id="outputTakeProfit"></span></p>
                    </div>
                </div>

                <!-- Game Plan Section -->
                <div class="analysis-section-card">
                    <h2>–ü–ª–∞–Ω –î–µ–π—Å—Ç–≤–∏–π</h2>
                    <p class="game-plan-text" id="outputGamePlan">
                        –ë–∏—Ç–∫–æ–π–Ω –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ç–æ—Ä–≥—É–µ—Ç—Å—è –æ–∫–æ–ª–æ $98,218 –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–∏–ª—å–Ω—ã–π –±—ã—á–∏–π –∏–º–ø—É–ª—å—Å —Å –≤—ã—Å–æ–∫–∏–º –æ–±—ä–µ–º–æ–º, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ä–∞—Å—Ç—É—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å. –ú–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π –ø–ª–∞–Ω —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ –¥–ª–∏–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –æ–∫–æ–ª–æ $97,500, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å —á—É—Ç—å –Ω–∏–∂–µ –Ω–µ–¥–∞–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ $95,000 –∏ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ —Ü–µ–ª–∏ –≤ $105,000, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–º —É—Ä–æ–≤–Ω—è–º —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. (–¥–µ–º–æ)
                    </p>
                </div>

                <!-- Detailed Analysis Section (Locked for basic plan) -->
                <div class="analysis-section-card relative">
                    <h2>–î–µ—Ç–∞–ª—å–Ω—ã–π –ê–Ω–∞–ª–∏–∑</h2>
                    <ul class="detailed-analysis-list locked-content">
                        <li>
                            <span class="number">1</span>
                            <span class="text-content" id="detailedAnalysis1">–í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
                            <span class="lock-icon">üîí</span>
                        </li>
                        <li>
                            <span class="number">2</span>
                            <span class="text-content" id="detailedAnalysis2">–í—Å–ø–ª–µ—Å–∫–∏ –æ–±—ä–µ–º–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤</span>
                            <span class="lock-icon">üîí</span>
                        </li>
                        <li>
                            <span class="number">3</span>
                            <span class="text-content" id="detailedAnalysis3">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—Å–µ–æ–±—ä–µ–º–ª—é—â–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞</span>
                            <span class="lock-icon">üîí</span>
                        </li>
                        <li>
                            <span class="number">4</span>
                            <span class="text-content" id="detailedAnalysis4">–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π</span>
                            <span class="lock-icon">üîí</span>
                        </li>
                        <li>
                            <span class="number">5</span>
                            <span class="text-content" id="detailedAnalysis5">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ</span>
                            <span class="lock-icon">üîí</span>
                        </li>
                    </ul>
                    <div class="lock-overlay" id="detailedAnalysisLockOverlay">
                        <span class="text-2xl">–î–æ—Å—Ç—É–ø–Ω–æ –≤ –ü—Ä–µ–º–∏—É–º –ø–ª–∞–Ω–µ üîí</span>
                    </div>
                </div>
            </div>

            <div id="errorMessage" class="hidden bg-red-800 border border-red-600 text-red-200 px-4 py-3 rounded-md mt-4" role="alert">
                <strong class="font-bold">–û—à–∏–±–∫–∞!</strong>
                <span class="block sm:inline" id="errorText"></span>
            </div>

            <button class="btn-primary w-full mt-auto" onclick="showPage('subscriptionPage')">–°–º–µ–Ω–∏—Ç—å –ø–ª–∞–Ω</button>
        </div>

        <!-- Subscription Page -->
        <div id="subscriptionPage" class="page">
            <h2 class="text-xl font-semibold text-center mb-4">–ù–∞—à–∏ –ü–æ–¥–ø–∏—Å–∫–∏</h2>
            <div class="subscription-plan">
                <h3>–ë–∞–∑–æ–≤—ã–π –ø–ª–∞–Ω</h3>
                <p>–î–æ—Å—Ç—É–ø –∫ –±–∞–∑–æ–≤–æ–º—É –∞–Ω–∞–ª–∏–∑—É.</p>
                <p class="font-bold text-lg mt-2">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</p>
            </div>
            <div class="subscription-plan">
                <h3>–ü—Ä–µ–º–∏—É–º –ø–ª–∞–Ω</h3>
                <p>–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ AI-–∞–Ω–∞–ª–∏–∑—É, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º –∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–º —Å–∏–≥–Ω–∞–ª–∞–º.</p>
                <p class="font-bold text-lg mt-2">9.99 Stars/–º–µ—Å—è—Ü</p>
                <button class="btn-primary w-full mt-3" onclick="requestSubscriptionPayment(999)">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
            </div>
            <div class="subscription-plan">
                <h3>VIP –ø–ª–∞–Ω</h3>
                <p>–í—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ü—Ä–µ–º–∏—É–º –ø–ª–∞–Ω–∞ –ø–ª—é—Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ —Ä–∞–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ –Ω–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º.</p>
                <p class="font-bold text-lg mt-2">29.99 Stars/–º–µ—Å—è—Ü</p>
                <button class="btn-primary w-full mt-3" onclick="requestSubscriptionPayment(2999)">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
            </div>
            <button class="btn-secondary w-full mt-auto" onclick="showPage('analysisPage')">–ù–∞–∑–∞–¥ –∫ –ê–Ω–∞–ª–∏–∑—É</button>
        </div>

        <!-- Payment Page -->
        <div id="paymentPage" class="page">
            <h2 class="text-xl font-semibold text-center mb-4">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–∞–ª–∞–Ω—Å–∞</h2>
            <div class="payment-info">
                <img src="https://placehold.co/80x80/0088CC/FFFFFF?text=%E2%AD%90" alt="Telegram Stars Icon" class="mx-auto mb-4">
                <p class="mb-4">–î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Telegram Stars.</p>
                <p class="mb-4">–í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: <span class="font-bold text-blue-600" id="userStarsBalance">0 Stars</span></p>
                <button id="addStarsBtn" class="btn-primary w-full">–ü–æ–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ Telegram Stars (100 Stars)</button>
                <p class="text-sm text-gray-400 mt-4">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫—É–ø–∫–∏ Telegram Stars.</p>
            </div>
            <button class="btn-secondary w-full mt-auto" onclick="showPage('subscriptionPage')">–ù–∞–∑–∞–¥ –∫ –ü–æ–¥–ø–∏—Å–∫–∞–º</button>
        </div>

        <!-- Instruction Modal -->
        <div id="instructionModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden">
            <div class="bg-gray-800 rounded-lg p-6 max-w-sm w-full relative">
                <h2 class="text-xl font-bold text-white mb-4 text-center">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
                <p class="text-gray-300 mb-4">
                    1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≥—Ä–∞—Ñ–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.<br>
                    2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑".<br>
                    3. AI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –≤–∞–º –∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏ –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π.<br>
                    4. –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ü—Ä–µ–º–∏—É–º –∏–ª–∏ VIP –ø–ª–∞–Ω.
                </p>
                <button class="btn-primary w-full" onclick="hideInstructionModal()">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>

    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const chartImageUpload = document.getElementById('chartImageUpload');
        const imageUploadArea = document.getElementById('imageUploadArea');
        const imagePreview = document.getElementById('imagePreview');
        const getAnalysisBtn = document.getElementById('getAnalysisBtn');
        const buttonText = document.getElementById('buttonText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const analysisResult = document.getElementById('analysisResult');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');

        // –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã–≤–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞
        const outputAction = document.getElementById('outputAction');
        const outputEntryPrice = document.getElementById('outputEntryPrice');
        const outputTargetPrice = document.getElementById('outputTargetPrice');
        const outputStopLoss = document.getElementById('outputStopLoss');
        const outputTakeProfit = document.getElementById('outputTakeProfit');
        const outputTrend = document.getElementById('outputTrend');
        const outputVolatility = document.getElementById('outputVolatility');
        const outputVolume = document.getElementById('outputVolume');
        const outputSentiment = document.getElementById('outputSentiment');
        const outputGamePlan = document.getElementById('outputGamePlan');
        const detailedAnalysis1 = document.getElementById('detailedAnalysis1');
        const detailedAnalysis2 = document.getElementById('detailedAnalysis2');
        const detailedAnalysis3 = document.getElementById('detailedAnalysis3');
        const detailedAnalysis4 = document.getElementById('detailedAnalysis4');
        const detailedAnalysis5 = document.getElementById('detailedAnalysis5');
        const detailedAnalysisLockOverlay = document.getElementById('detailedAnalysisLockOverlay');


        // –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
        const welcomePage = document.getElementById('welcomePage');
        const analysisPage = document.getElementById('analysisPage');
        const subscriptionPage = document.getElementById('subscriptionPage');
        const paymentPage = document.getElementById('paymentPage');
        const instructionModal = document.getElementById('instructionModal');


        // –ö–Ω–æ–ø–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è Stars –∏ –±–∞–ª–∞–Ω—Å
        const addStarsBtn = document.getElementById('addStarsBtn');
        const userStarsBalance = document.getElementById('userStarsBalance');

        let uploadedImageBase64 = null; // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω –¥–ª—è –ª—É—á—à–µ–≥–æ UX
        } else {
            console.warn('Telegram Web App API not available. Running in standalone mode. Real payments will not work.');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–≤–µ—Ä—Ö –ø—Ä–∏ —Å–º–µ–Ω–µ
            window.scrollTo(0, 0);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        function showInstructionModal() {
            instructionModal.classList.remove('hidden');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        function hideInstructionModal() {
            instructionModal.classList.add('hidden');
        }


        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        imageUploadArea.addEventListener('click', () => {
            chartImageUpload.click();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ input
        chartImageUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    uploadedImageBase64 = e.target.result.split(',')[1]; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ base64 —á–∞—Å—Ç—å
                };
                reader.readAsDataURL(file);
            } else {
                imagePreview.src = '#';
                imagePreview.style.display = 'none';
                uploadedImageBase64 = null;
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∞–Ω–∞–ª–∏–∑–∞
        getAnalysisBtn.addEventListener('click', async () => {
            if (!uploadedImageBase64) {
                showErrorMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.');
                return;
            }

            showLoading(true);
            hideErrorMessage();
            hideAnalysisResult();

            try {
                // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
                await new Promise(resolve => setTimeout(resolve, 2500)); // –£–≤–µ–ª–∏—á–∏–ª –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –ª—É—á—à–µ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

                // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
                const dummyAnalysisData = {
                    action: Math.random() < 0.5 ? '–ö–£–ü–ò–¢–¨' : '–ü–†–û–î–ê–¢–¨', // –°–ª—É—á–∞–π–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
                    entryPrice: '777',
                    targetPrice: '777',
                    stopLoss: '777',
                    takeProfit: '777',
                    trend: '–ë—ã—á–∏–π',
                    volatility: '–°—Ä–µ–¥–Ω—è—è',
                    volume: '–í—ã—Å–æ–∫–∏–π',
                    sentiment: '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ',
                    gamePlan: '–ë–∏—Ç–∫–æ–π–Ω –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ç–æ—Ä–≥—É–µ—Ç—Å—è –æ–∫–æ–ª–æ $98,218 –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–∏–ª—å–Ω—ã–π –±—ã—á–∏–π –∏–º–ø—É–ª—å—Å —Å –≤—ã—Å–æ–∫–∏–º –æ–±—ä–µ–º–æ–º, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ä–∞—Å—Ç—É—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å. –ú–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π –ø–ª–∞–Ω —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ –¥–ª–∏–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –æ–∫–æ–ª–æ $97,500, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å —á—É—Ç—å –Ω–∏–∂–µ –Ω–µ–¥–∞–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ $95,000 –∏ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ —Ü–µ–ª–∏ –≤ $105,000, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–º —É—Ä–æ–≤–Ω—è–º —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. (–¥–µ–º–æ)',
                    detailedAnalysis: [
                        '–í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å',
                        '–í—Å–ø–ª–µ—Å–∫–∏ –æ–±—ä–µ–º–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤',
                        '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—Å–µ–æ–±—ä–µ–º–ª—é—â–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞',
                        '–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π',
                        '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ'
                    ],
                    planLevel: 'basic' // 'basic', 'premium', 'vip' - –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                };

                // –û–±–Ω–æ–≤–ª—è–µ–º UI —Å –∑–∞–≥–ª—É—à–µ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                outputAction.textContent = dummyAnalysisData.action;
                outputEntryPrice.textContent = dummyAnalysisData.entryPrice;
                outputTargetPrice.textContent = dummyAnalysisData.targetPrice;
                outputStopLoss.textContent = dummyAnalysisData.stopLoss;
                outputTakeProfit.textContent = dummyAnalysisData.takeProfit;
                outputTrend.textContent = dummyAnalysisData.trend;
                outputVolatility.textContent = dummyAnalysisData.volatility;
                outputVolume.textContent = dummyAnalysisData.volume;
                outputSentiment.textContent = dummyAnalysisData.sentiment;
                outputGamePlan.textContent = dummyAnalysisData.gamePlan;
                detailedAnalysis1.textContent = dummyAnalysisData.detailedAnalysis[0];
                detailedAnalysis2.textContent = dummyAnalysisData.detailedAnalysis[1];
                detailedAnalysis3.textContent = dummyAnalysisData.detailedAnalysis[2];
                detailedAnalysis4.textContent = dummyAnalysisData.detailedAnalysis[3];
                detailedAnalysis5.textContent = dummyAnalysisData.detailedAnalysis[4];


                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è
                if (dummyAnalysisData.action === '–ö–£–ü–ò–¢–¨') {
                    outputAction.className = 'font-bold text-green-600';
                } else if (dummyAnalysisData.action === '–ü–†–û–î–ê–¢–¨') {
                    outputAction.className = 'font-bold text-red-600';
                } else {
                    outputAction.className = 'font-bold text-gray-400';
                }

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
                if (dummyAnalysisData.planLevel === 'basic') {
                    detailedAnalysisLockOverlay.classList.remove('hidden');
                } else {
                    detailedAnalysisLockOverlay.classList.add('hidden');
                }

                showAnalysisResult();

                // –í –±—É–¥—É—â–µ–º –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ AI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
                /*
                const prompt = "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –≥—Ä–∞—Ñ–∏–∫ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ö–£–ü–ò–¢–¨/–ü–†–û–î–ê–¢–¨/–î–ï–†–ñ–ê–¢–¨), —Ü–µ–Ω—É –≤—Ö–æ–¥–∞, —Ü–µ–ª–µ–≤—É—é —Ü–µ–Ω—É, —Å—Ç–æ–ø-–ª–æ—Å—Å, —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç, –∫—Ä–∞—Ç–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –∫—Ä–∞—Ç–∫–∏–π –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –∞–Ω–∞–ª–∏–∑. –§–æ—Ä–º–∞—Ç–∏—Ä—É–π—Ç–µ –æ—Ç–≤–µ—Ç –∫–∞–∫ JSON –æ–±—ä–µ–∫—Ç.";
                const chatHistory = [];
                const payload = {
                    contents: [
                        {
                            role: "user",
                            parts: [
                                { text: prompt },
                                {
                                    inlineData: {
                                        mimeType: "image/jpeg", // –ò–ª–∏ "image/png" –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ
                                        data: uploadedImageBase64
                                    }
                                }
                            ]
                        }
                    ],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: { // –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–∞—à—É —Å—Ö–µ–º—É –∑–¥–µ—Å—å
                            type: "OBJECT",
                            properties: {
                                "action": { "type": "STRING" },
                                "entryPrice": { "type": "STRING" },
                                "targetPrice": { "type": "STRING" },
                                "stopLoss": { "type": "STRING" },
                                "takeProfit": { "type": "STRING" },
                                "technicalAnalysis": { "type": "STRING" },
                                "newsAnalysis": { "type": "STRING" }
                            }
                        }
                    }
                };

                const apiKey = ""; // API –∫–ª—é—á –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Å—Ä–µ–¥–æ–π Canvas
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ result –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
                */

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞:', error);
                showErrorMessage('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            } finally {
                showLoading(false);
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–ª–∞—Ç–µ–∂–∞ Stars –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É
        function requestSubscriptionPayment(starsAmount) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–≤–æ–π—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±–æ—Ç–∞
            // –∏ –ø–æ–ª—É—á–µ–Ω–∏—è invoice_url –∏–ª–∏ invoice_payload
            const invoicePayload = `subscription_plan_${starsAmount}`; // –ü—Ä–∏–º–µ—Ä payload

            if (Telegram.WebApp && Telegram.WebApp.requestPayment) {
                Telegram.WebApp.requestPayment({
                    amount: starsAmount, // –°—É–º–º–∞ –≤ Stars (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
                    asset: 'stars', // –í—Å–µ–≥–¥–∞ 'stars' –¥–ª—è Telegram Stars
                    payload: invoicePayload // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –≤–∞—à–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                }, (status) => {
                    if (status.status === 'succeeded') {
                        updateStarsBalance(starsAmount); // –î–µ–º–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                        Telegram.WebApp.showAlert(`–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ ${starsAmount / 100} Stars —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—á–µ–Ω–∞!`);
                    } else {
                        Telegram.WebApp.showAlert(`–û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã –∏–ª–∏ –æ—Ç–º–µ–Ω–∞: ${status.status}`);
                    }
                });
            } else {
                console.warn(`Telegram Web App API not available. Cannot request payment for ${starsAmount / 100} Stars.`);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ Telegram Stars"
        addStarsBtn.addEventListener('click', () => {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–≤–æ–π—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±–æ—Ç–∞
            // –∏ –ø–æ–ª—É—á–µ–Ω–∏—è invoice_url –∏–ª–∏ invoice_payload
            const starsToBuy = 100; // –ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –∫—É–ø–∏—Ç—å 100 Stars
            const invoicePayload = `top_up_${starsToBuy}`; // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π payload –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è

            if (Telegram.WebApp && Telegram.WebApp.requestPayment) {
                Telegram.WebApp.requestPayment({
                    amount: starsToBuy,
                    asset: 'stars',
                    payload: invoicePayload
                }, (status) => {
                    if (status.status === 'succeeded') {
                        updateStarsBalance(starsToBuy); // –î–µ–º–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                        Telegram.WebApp.showAlert(`–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–ø–æ–ª–Ω–∏–ª–∏ –±–∞–ª–∞–Ω—Å –Ω–∞ ${starsToBuy} Stars!`);
                    } else {
                        Telegram.WebApp.showAlert(`–û—à–∏–±–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–º–µ–Ω–∞: ${status.status}`);
                    }
                });
            } else {
                console.warn(`Telegram Web App API not available. Cannot request payment for ${starsToBuy} Stars.`);
            }
        });

        // –î–µ–º–æ-—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ Stars
        function updateStarsBalance(amount) {
            let currentBalance = parseFloat(userStarsBalance.textContent.replace(' Stars', ''));
            currentBalance += amount / 100; // –î–µ–ª–∏–º –Ω–∞ 100, —Ç–∞–∫ –∫–∞–∫ –≤ UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º 9.99, –∞ –≤ API —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
            userStarsBalance.textContent = `${currentBalance.toFixed(2)} Stars`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Å–ø–∏–Ω–Ω–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
        function showLoading(isLoading) {
            if (isLoading) {
                buttonText.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                loadingSpinner.classList.remove('hidden');
                getAnalysisBtn.disabled = true;
            } else {
                buttonText.textContent = '–ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑';
                loadingSpinner.classList.add('hidden');
                getAnalysisBtn.disabled = false;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–µ–∫—Ü–∏–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
        function showAnalysisResult() {
            analysisResult.classList.remove('hidden');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å–µ–∫—Ü–∏–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
        function hideAnalysisResult() {
            analysisResult.classList.add('hidden');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
        function showErrorMessage(message) {
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
        function hideErrorMessage() {
            errorMessage.classList.add('hidden');
        }

    </script>
</body>
</html>
